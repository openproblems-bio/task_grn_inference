__merge__: ../../api/comp_metric.yaml

name: gs_recovery
namespace: "metrics"
info:
  label: Pathway Annotation Fidelity
  summary: Evaluates GRN quality based on pathway enrichment of TF targets

arguments:
  # Individual geneset file arguments
  - name: "--geneset_hallmark_2020"
    type: file
    required: false
    description: Hallmark 2020 geneset GMT file
    example: resources_test/grn_benchmark/prior/pathways/reactome_2022.gmt
  
  - name: "--geneset_kegg_2021"
    type: file
    required: false
    description: KEGG 2021 geneset GMT file
    example: resources_test/grn_benchmark/prior/pathways/reactome_2022.gmt
  
  - name: "--geneset_reactome_2022"
    type: file
    required: false
    description: Reactome 2022 geneset GMT file
    example: resources_test/grn_benchmark/prior/pathways/reactome_2022.gmt
  
  - name: "--geneset_go_bp_2023"
    type: file
    required: false
    description: GO Biological Process 2023 geneset GMT file
    example: resources_test/grn_benchmark/prior/pathways/reactome_2022.gmt
  
  - name: "--geneset_bioplanet_2019"
    type: file
    required: false
    description: BioPlanet 2019 geneset GMT file
    example: resources_test/grn_benchmark/prior/pathways/reactome_2022.gmt
  
  - name: "--geneset_wikipathways_2019"
    type: file
    required: false
    description: WikiPathways 2019 geneset GMT file
    example: resources_test/grn_benchmark/prior/pathways/reactome_2022.gmt
  
  - name: "--fdr_threshold"
    type: double
    required: false
    default: 0.05
    description: FDR threshold for significant pathway enrichment
  
  - name: "--min_pathway_size"
    type: integer
    required: false
    default: 5
    description: Minimum number of genes in a pathway to be considered
  
  - name: "--max_pathway_size"
    type: integer
    required: false
    default: 500
    description: Maximum number of genes in a pathway to be considered
  
  - name: "--min_targets"
    type: integer
    required: false
    default: 10
    description: Minimum number of targets for a TF to be evaluated
  
  - name: "--max_targets"
    type: integer
    required: false
    default: 100
    description: Maximum number of targets per TF (top K by absolute edge weight). Handles network density variation.

  - name: "--ulm_activity_threshold"
    type: double
    required: false
    default: 0.0
    description: Minimum activity score for pathway to be considered active
  
  - name: "--ulm_pvalue_threshold"
    type: double
    required: false
    default: 0.01
    description: P-value threshold for pathway activity significance
  
  - name: "--ulm_baseline_method"
    type: string
    required: false
    default: "zero_centered"
    description: "Method for determining pathway activity baseline (zero_centered, permutation, or random_genesets)"
    
  - name: "--output_detailed_metrics"
    type: boolean
    required: false
    default: false
    description: Whether to output detailed per-geneset metrics or only summary metrics
  
resources:
  - type: python_script
    path: script.py
  - path: /src/utils/util.py
    dest: util.py
  - path: helper.py
  
engines:
  - type: docker
    image: ghcr.io/openproblems-bio/base_python:1.0.4
    __merge__: /src/api/base_requirements.yaml
    setup:
      - type: python
        packages: [decoupler==2.1.1]
runners:
  - type: executable
  - type: nextflow
    directives:
      label: [ midtime, midmem, midcpu ]